!function(){"use strict";class e{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._errorList=e.errorList,this._inputElements=Array.from(this._form.querySelectorAll(this._inputSelector)),this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageElement.textContent=e.validationMessage,this._errorMessageElement.classList.add(this._errorClass)}_hideInputError(e){this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageElement.textContent="",this._errorMessageElement.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return Array.from(this._inputElements).some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._form.reset(),this._toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}}class t{constructor(e,t,s,r,n,a,i){this._name=e.name,this._link=e.link,this._id=e._id,this._isLiked=Array.isArray(e.likes)&&e.likes.some((e=>e._id===i)),this._cardSelector=t,this._data=e,this._handleImageClick=s,this._handleDeleteButtonClick=a,this._handleLikeCard=r,this._handleUnlikeCard=n,this._currentUserId=i,this._cardElement=this._getTemplate()}_getTemplate(){const e=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0);return this._likeButton=e.querySelector(".card__like-button"),this._deleteButton=e.querySelector(".card__delete-button"),this._cardImageEl=e.querySelector(".card__image"),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteButtonClick(this._id)})),e}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeButton()})),this._cardImageEl.addEventListener("click",(()=>{this._handleImageClick(this._data)}))}_handleLikeButton(){this._isLiked?this._handleUnlikeCard(this._id).then((()=>{this._isLiked=!1,this._updateLikeStatus()})).catch((e=>{console.error(`Error unliking card: ${e}`)})):this._handleLikeCard(this._id).then((()=>{this._isLiked=!0,this._updateLikeStatus()})).catch((e=>{console.error(`Error liking card: ${e}`)}))}_updateLikeStatus(){this._likeButton?this._isLiked?this._likeButton.classList.add("card__like-button-active"):this._likeButton.classList.remove("card__like-button-active"):console.error("Like button not found.")}getView(){return this._element=this._cardElement,this._element.setAttribute("data-id",this._id),this._element.querySelector(".card__title").textContent=this._name,this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._updateLikeStatus(),this._setEventListeners(),this._element}updateLikeStatus(e){this._isLiked=e,this._updateLikeStatus()}}class s{constructor(e){let{modalSelector:t}=e;this._modalElement=document.querySelector(t),this._closeButton=this._modalElement.querySelector(".modal__close"),this._handleEscapeKey=this._handleEscapeKey.bind(this)}open(){this._modalElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscapeKey)}close(){this._modalElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscapeKey)}_handleEscapeKey(e){"Escape"===e.key&&this.close()}_setEventListeners(){this._modalElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()})),this._closeButton.addEventListener("click",(()=>{this.close()}))}}class r extends s{constructor(e,t){super({modalSelector:e}),this._modalForm=this._modalElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputElements=this._modalForm.querySelectorAll(".modal__input")}_getInputValues(){const e={};return this._inputElements.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super._setEventListeners(),this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}}const n=document.querySelectorAll(".modal__form"),a=document.querySelector("#profile__edit-button-js"),i=(document.forms["profile-edit-form"],document.querySelector("#profile__add-button-js")),o={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible",errorList:"modal__error"},l=document.querySelector("[name='name']"),d=document.querySelector("[name='about']"),c=document.querySelector(".profile__avatar"),h=document.querySelector("#avatar-edit-modal .modal__button"),u=document.querySelector("#profile-edit-modal .modal__button"),_=document.querySelector("#add-button-modal .modal__button"),m=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInfoAndCards(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}createCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}updateUserInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}updateUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a44aa497-1b5c-4737-a030-aa953cdc7c47","Content-Type":"application/json"}}),p=new class{constructor(e,t){let{items:s,renderer:r}=e;this._renderItems=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(e){e.reverse().forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}getItem(e){return this._renderItems.find((t=>t.id===e))}}({items:[],renderer:function(e){const t=g(e);p.addItem(t)}},".cards__list"),E=new r("#profile-edit-modal",(function(e){u.textContent="Saving...";const t={name:e.name,about:e.about};m.updateUserInfo(t).then((e=>{L.setUserInfo(e),E.close()})).catch((e=>{console.error("Error updating user information:",e)})).finally((()=>{u.textContent="Save"}))}));E.setEventListeners();const v=new r("#add-button-modal",(function(e){_.textContent="Saving...";const t={name:e.title,link:e.image,likes:[]};m.createCard(t).then((e=>{p.addItem(g(e)),v.close()})).catch((e=>{console.error("Error creating card:",e)})).finally((()=>{_.textContent="Create"}))}));v.setEventListeners();const S=new class extends s{constructor(e){super({modalSelector:e}),this._modalImage=this._modalElement.querySelector(".modal__image"),this._modalImageCaption=this._modalElement.querySelector(".modal__caption")}open(e){this._modalImage.src=e.link,this._modalImage.alt=e.name,this._modalImageCaption.textContent=e.name,super.open()}setEventListeners(){super._setEventListeners(),this._modalImage.addEventListener("submit",(e=>{e.preventDefault()}))}}("#preview-image-modal");S.setEventListeners();const f=new class extends s{constructor(e,t){super({modalSelector:e}),this._modalForm=this._modalElement.querySelector(".modal__form"),this._inputElement=this._modalForm.querySelector("#avatar-image-input"),this._errorElement=this._modalForm.querySelector("#avatar-image-input-error"),this._handleAvatarImageSubmit=t}setEventListeners(){super._setEventListeners(),document.querySelector(".profile__avatar-button").addEventListener("click",(()=>{console.log("Avatar button clicked"),this.open()})),this._modalForm.addEventListener("submit",(e=>{e.preventDefault();const t=this._inputElement.value.trim();t?(this._handleAvatarImageSubmit({avatar:t}),this.close()):console.error("Avatar URL is required.")}))}}("#avatar-edit-modal",(function(e){h&&(h.textContent="Saving...");const t=e.avatar;t?m.updateUserAvatar(t).then((e=>{console.log("User avatar updated successfully:",e),function(e){c.src=e;const t=new CustomEvent("avatarUpdate",{detail:e});document.dispatchEvent(t)}(e.avatar),f.close()})).catch((e=>{console.error("Error updating user avatar:",e)})).finally((()=>{avatarUpdateButton&&(h.textContent="Save")})):console.error("Avatar URL is required.")}));f.setEventListeners();const k=new class extends s{constructor(e,t){super({modalSelector:e}),this._handleDeleteCardSubmit=t,this._confirmButton=this._modalElement.querySelector(".modal__button")}setEventListeners(){super._setEventListeners(),this._confirmButton.addEventListener("click",(()=>{const e=this._modalElement.dataset.cardId;this._handleDeleteCardSubmit(e),this.close()}))}open(e){this._modalElement.dataset.cardId=e,super.open()}}("#delete-card-modal",(function(e){m.deleteCard(e).then((()=>{const t=document.querySelector(`[data-id='${e}']`);t&&t.remove()})).catch((e=>{console.error("Error deleting card:",e)}))}));k.setEventListeners();const L=new class{constructor(e){let{nameElementSelector:t,aboutElementSelector:s,avatarImageSelector:r}=e;this._nameElement=document.querySelector(t),this._aboutElement=document.querySelector(s),this._avatarImage=document.querySelector(r),document.addEventListener("avatarUpdate",(e=>{const t=e.detail;this._avatarImage.src=t}))}getUserInfo(){return this._userInfo={name:this._nameElement.textContent,about:this._aboutElement.textContent},this._userInfo}setUserInfo(e){let{name:t,about:s}=e;this._nameElement.textContent=t,this._aboutElement.textContent=s}getUserId(){return this._userId}}({nameElementSelector:".profile__title",aboutElementSelector:".profile__description"});function g(e){return new t(e,"#card-template",(()=>{S.open(e)}),b,y,I,L.getUserId()).getView()}function b(e){return m.likeCard(e).then((()=>{const t=p.getItem(e);t&&t._updateLikeStatus(!0)})).catch((e=>{console.error(`Error liking card: ${e}`)}))}function y(e){return m.unlikeCard(e).then((()=>{const t=p.getItem(e);t&&t._updateLikeStatus(!1)})).catch((e=>{console.error(`Error unliking card: ${e}`)}))}function I(e){k.open(e)}document.addEventListener("DOMContentLoaded",(()=>{m.getUserInfoAndCards().then((e=>{let[t,s]=e;s=s.map((e=>({...e,likes:e.likes||[]}))),l.value=t.name||"",d.value=t.about||"",L.setUserInfo(t),p.renderItems(s)})).catch((e=>{console.error("Error fetching user info and cards:",e)}))})),a.addEventListener("click",(()=>{const e=L.getUserInfo();l.value=e.name.trim(),d.value=e.about.trim(),E.open()})),i.addEventListener("click",(()=>{v.open(),C["add-button-form"].resetValidation()})),c.addEventListener("click",(()=>{f.open()}));const C={};(t=>{t.forEach((t=>{const s=new e(o,t);return s.enableValidation(),C[t.getAttribute("id")]=s,C}))})(n)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUE4QixJQUE1QitILEVBQVVDLEdBQWFoSSxFQUM3QmdJLEVBQWVBLEVBQWFDLEtBQUtILElBQUksSUFDaENBLEVBQ0gvSixNQUFPK0osRUFBSy9KLE9BQVMsT0FFdkI0RCxFQUFVUCxNQUFRMkcsRUFBU3RLLE1BQVEsR0FDbkNtRSxFQUFXUixNQUFRMkcsRUFBUzFDLE9BQVMsR0FDckN2QixFQUFTeUIsWUFBWXdDLEdBQ3JCNUQsRUFBYU8sWUFBWXNELEVBQWEsSUFFdkM1SSxPQUFPQyxJQUNOQyxRQUFRQyxNQUFNLHNDQUF1Q0YsRUFBSSxHQUN6RCxJQTRCTmtDLEVBQWtCN0UsaUJBQWlCLFNBQVMsS0FDMUMsTUFBTXdMLEVBQWNwRSxFQUFTZCxjQUM3QnJCLEVBQVVQLE1BQVE4RyxFQUFZekssS0FBSzhJLE9BQ25DM0UsRUFBV1IsTUFBUThHLEVBQVk3QyxNQUFNa0IsT0FFckNwQixFQUFhN0UsTUFBTSxJQUdyQmtCLEVBQW9COUUsaUJBQWlCLFNBQVMsS0FDNUMrSSxFQUFVbkYsT0FDVjZILEVBQWUsbUJBQW1CckwsaUJBQWlCLElBR3JEK0UsRUFBWW5GLGlCQUFpQixTQUFTLEtBQ3BDc0osRUFBZ0IxRixNQUFNLElBbUl4QixNQUFNNkgsRUFBaUIsQ0FBQyxFQUNFN0csS0FDeEJBLEVBQVM3RSxTQUFTMkwsSUFDaEIsTUFBTUMsRUFBZ0IsSUFBSXRPLEVBQWNFLEVBQVVtTyxHQUdsRCxPQUZBQyxFQUFjekwsbUJBQ2R1TCxFQUFlQyxFQUFLRSxhQUFhLE9BQVNELEVBQ25DRixDQUFjLEdBQ3JCLEVBR0p2TCxDQUFpQjBFLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvTW9kYWwuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL01vZGFsV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Nb2RhbFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvTW9kYWxFZGl0QXZhdGFyLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Nb2RhbERlbGV0ZUNhcmQuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JMaXN0ID0gc2V0dGluZ3MuZXJyb3JMaXN0O1xuICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXG4gICAgKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5faW5wdXRFbGVtZW50cykuc29tZShcbiAgICAgIChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcbiAgICApO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZSkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgZGF0YSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVMaWtlQ2FyZCxcbiAgICBoYW5kbGVVbmxpa2VDYXJkLFxuICAgIGhhbmRsZURlbGV0ZUJ1dHRvbkNsaWNrLFxuICAgIGN1cnJlbnRVc2VySWRcbiAgKSB7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5faXNMaWtlZCA9XG4gICAgICBBcnJheS5pc0FycmF5KGRhdGEubGlrZXMpICYmXG4gICAgICBkYXRhLmxpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09PSBjdXJyZW50VXNlcklkKTtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2sgPSBoYW5kbGVEZWxldGVCdXR0b25DbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCA9IGhhbmRsZUxpa2VDYXJkO1xuICAgIHRoaXMuX2hhbmRsZVVubGlrZUNhcmQgPSBoYW5kbGVVbmxpa2VDYXJkO1xuICAgIHRoaXMuX2N1cnJlbnRVc2VySWQgPSBjdXJyZW50VXNlcklkO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCB0ZW1wbGF0ZSA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGVtcGxhdGUucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsID0gdGVtcGxhdGUucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcblxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2sodGhpcy5faWQpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRlbXBsYXRlO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24oKTtcbiAgICB9KTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzLl9kYXRhKTtcbiAgICB9KTtcbiAgfVxuXG4gIF9oYW5kbGVMaWtlQnV0dG9uKCkge1xuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9oYW5kbGVVbmxpa2VDYXJkKHRoaXMuX2lkKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgdGhpcy5faXNMaWtlZCA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuX3VwZGF0ZUxpa2VTdGF0dXMoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciB1bmxpa2luZyBjYXJkOiAke2Vycn1gKTtcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkKHRoaXMuX2lkKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgdGhpcy5faXNMaWtlZCA9IHRydWU7XG4gICAgICAgICAgdGhpcy5fdXBkYXRlTGlrZVN0YXR1cygpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGxpa2luZyBjYXJkOiAke2Vycn1gKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgX3VwZGF0ZUxpa2VTdGF0dXMoKSB7XG4gICAgaWYgKHRoaXMuX2xpa2VCdXR0b24pIHtcbiAgICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uLWFjdGl2ZVwiKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uLWFjdGl2ZVwiKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5lcnJvcihcIkxpa2UgYnV0dG9uIG5vdCBmb3VuZC5cIik7XG4gICAgfVxuICB9XG5cbiAgZ2V0VmlldygpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gICAgdGhpcy5fZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsIHRoaXMuX2lkKTtcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWx0ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl91cGRhdGVMaWtlU3RhdHVzKCk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG5cbiAgdXBkYXRlTGlrZVN0YXR1cyhpc0xpa2VkKSB7XG4gICAgdGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XG4gICAgdGhpcy5fdXBkYXRlTGlrZVN0YXR1cygpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbCB7XG4gIGNvbnN0cnVjdG9yKHsgbW9kYWxTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbW9kYWxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihtb2RhbFNlbGVjdG9yKTtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NhcGVLZXkgPSB0aGlzLl9oYW5kbGVFc2NhcGVLZXkuYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjYXBlS2V5KTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY2FwZUtleSk7XG4gIH1cblxuICBfaGFuZGxlRXNjYXBlS2V5KGUpIHtcbiAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsV2l0aEZvcm0gZXh0ZW5kcyBNb2RhbCB7XG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcih7IG1vZGFsU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fbW9kYWxGb3JtID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IHRoaXMuX21vZGFsRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9tb2RhbEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fZm9ybVwiKTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZV9fZWRpdC1idXR0b24tanNcIlxuKTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LmZvcm1zW1wicHJvZmlsZS1lZGl0LWZvcm1cIl07XG5cbmV4cG9ydCBjb25zdCBhZGRjcmVhdGVDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZV9fYWRkLWJ1dHRvbi1qc1wiXG4pO1xuXG5leHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxuICBlcnJvckxpc3Q6IFwibW9kYWxfX2Vycm9yXCIsXG59O1xuXG5leHBvcnQgY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIltuYW1lPSduYW1lJ11cIik7XG5leHBvcnQgY29uc3QgYWJvdXRJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJbbmFtZT0nYWJvdXQnXVwiKTtcblxuZXhwb3J0IGNvbnN0IGF2YXRhckltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXJcIik7XG5cbmV4cG9ydCBjb25zdCBhdmF0YXJTYXZlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjYXZhdGFyLWVkaXQtbW9kYWwgLm1vZGFsX19idXR0b25cIlxuKTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVTYXZlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1lZGl0LW1vZGFsIC5tb2RhbF9fYnV0dG9uXCJcbik7XG5cbmV4cG9ydCBjb25zdCBhZGRDYXJkU2F2ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI2FkZC1idXR0b24tbW9kYWwgLm1vZGFsX19idXR0b25cIlxuKTtcbiIsIi8vIElNUE9SVFNcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgTW9kYWxXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvTW9kYWxXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBNb2RhbFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL01vZGFsV2l0aEZvcm0uanNcIjtcbmltcG9ydCBNb2RhbEVkaXRBdmF0YXIgZnJvbSBcIi4uL2NvbXBvbmVudHMvTW9kYWxFZGl0QXZhdGFyLmpzXCI7XG5pbXBvcnQgTW9kYWxEZWxldGVDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL01vZGFsRGVsZXRlQ2FyZC5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IHtcbiAgZm9ybUxpc3QsXG4gIHNldHRpbmdzLFxuICBwcm9maWxlRWRpdEJ1dHRvbixcbiAgYWRkY3JlYXRlQ2FyZEJ1dHRvbixcbiAgbmFtZUlucHV0LFxuICBhYm91dElucHV0LFxuICBhdmF0YXJJbWFnZSxcbiAgYXZhdGFyU2F2ZUJ1dHRvbixcbiAgcHJvZmlsZVNhdmVCdXR0b24sXG4gIGFkZENhcmRTYXZlQnV0dG9uLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbi8vIEFQSVxuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJhNDRhYTQ5Ny0xYjVjLTQ3MzctYTAzMC1hYTk1M2NkYzdjNDdcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vLyBTRUNUSU9OIENMQVNTXG5cbmNvbnN0IGNhcmRzU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgaXRlbXM6IFtdLFxuICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkLFxuICB9LFxuICBcIi5jYXJkc19fbGlzdFwiXG4pO1xuXG4vLyBNT0RBTFNcblxuY29uc3QgcHJvZmlsZU1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oXG4gIFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxuICBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdFxuKTtcbnByb2ZpbGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBjYXJkTW9kYWwgPSBuZXcgTW9kYWxXaXRoRm9ybShcIiNhZGQtYnV0dG9uLW1vZGFsXCIsIGhhbmRsZUFkZENhcmRTdWJtaXQpO1xuY2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gbmV3IE1vZGFsV2l0aEltYWdlKFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIik7XG5wcmV2aWV3SW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBhdmF0YXJFZGl0TW9kYWwgPSBuZXcgTW9kYWxFZGl0QXZhdGFyKFxuICBcIiNhdmF0YXItZWRpdC1tb2RhbFwiLFxuICBoYW5kbGVBdmF0YXJJbWFnZVN1Ym1pdFxuKTtcbmF2YXRhckVkaXRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBkZWxldGVDYXJkTW9kYWwgPSBuZXcgTW9kYWxEZWxldGVDYXJkKFxuICBcIiNkZWxldGUtY2FyZC1tb2RhbFwiLFxuICBoYW5kbGVEZWxldGVDYXJkXG4pO1xuZGVsZXRlQ2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIFVTRVIgSU5GT1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIG5hbWVFbGVtZW50U2VsZWN0b3I6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXG4gIGFib3V0RWxlbWVudFNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxufSk7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHtcbiAgYXBpXG4gICAgLmdldFVzZXJJbmZvQW5kQ2FyZHMoKVxuICAgIC50aGVuKChbdXNlckRhdGEsIGluaXRpYWxDYXJkc10pID0+IHtcbiAgICAgIGluaXRpYWxDYXJkcyA9IGluaXRpYWxDYXJkcy5tYXAoKGNhcmQpID0+ICh7XG4gICAgICAgIC4uLmNhcmQsXG4gICAgICAgIGxpa2VzOiBjYXJkLmxpa2VzIHx8IFtdLFxuICAgICAgfSkpO1xuICAgICAgbmFtZUlucHV0LnZhbHVlID0gdXNlckRhdGEubmFtZSB8fCBcIlwiO1xuICAgICAgYWJvdXRJbnB1dC52YWx1ZSA9IHVzZXJEYXRhLmFib3V0IHx8IFwiXCI7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YSk7XG4gICAgICBjYXJkc1NlY3Rpb24ucmVuZGVySXRlbXMoaW5pdGlhbENhcmRzKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgdXNlciBpbmZvIGFuZCBjYXJkczpcIiwgZXJyKTtcbiAgICB9KTtcbn0pO1xuXG4vLyBGVU5DVElPTlNcblxuZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoXG4gICAgZGF0YSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgKCkgPT4ge1xuICAgICAgcHJldmlld0ltYWdlTW9kYWwub3BlbihkYXRhKTtcbiAgICB9LFxuICAgIGhhbmRsZUxpa2VDYXJkLFxuICAgIGhhbmRsZVVubGlrZUNhcmQsXG4gICAgaGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2ssXG4gICAgdXNlckluZm8uZ2V0VXNlcklkKClcbiAgKTtcblxuICByZXR1cm4gY2FyZEVsZW1lbnQuZ2V0VmlldygpO1xufVxuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XG4gIGNhcmRzU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbn1cblxuLy8gRVZFTlQgTElTVEVORVJTXG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IGN1cnJlbnRVc2VyID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgbmFtZUlucHV0LnZhbHVlID0gY3VycmVudFVzZXIubmFtZS50cmltKCk7XG4gIGFib3V0SW5wdXQudmFsdWUgPSBjdXJyZW50VXNlci5hYm91dC50cmltKCk7XG5cbiAgcHJvZmlsZU1vZGFsLm9wZW4oKTtcbn0pO1xuXG5hZGRjcmVhdGVDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNhcmRNb2RhbC5vcGVuKCk7XG4gIGZvcm1WYWxpZGF0b3JzW1wiYWRkLWJ1dHRvbi1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG5cbmF2YXRhckltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGF2YXRhckVkaXRNb2RhbC5vcGVuKCk7XG59KTtcblxuLy8gRVZFTlQgSEFORExFUlNcblxuZnVuY3Rpb24gaGFuZGxlTGlrZUNhcmQoY2FyZElkKSB7XG4gIHJldHVybiBhcGlcbiAgICAubGlrZUNhcmQoY2FyZElkKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIGNvbnN0IGNhcmQgPSBjYXJkc1NlY3Rpb24uZ2V0SXRlbShjYXJkSWQpO1xuICAgICAgaWYgKGNhcmQpIHtcbiAgICAgICAgY2FyZC5fdXBkYXRlTGlrZVN0YXR1cyh0cnVlKTtcbiAgICAgIH1cbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBsaWtpbmcgY2FyZDogJHtlcnJ9YCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZVVubGlrZUNhcmQoY2FyZElkKSB7XG4gIHJldHVybiBhcGlcbiAgICAudW5saWtlQ2FyZChjYXJkSWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgY29uc3QgY2FyZCA9IGNhcmRzU2VjdGlvbi5nZXRJdGVtKGNhcmRJZCk7XG4gICAgICBpZiAoY2FyZCkge1xuICAgICAgICBjYXJkLl91cGRhdGVMaWtlU3RhdHVzKGZhbHNlKTtcbiAgICAgIH1cbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciB1bmxpa2luZyBjYXJkOiAke2Vycn1gKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQnV0dG9uQ2xpY2soY2FyZElkKSB7XG4gIGRlbGV0ZUNhcmRNb2RhbC5vcGVuKGNhcmRJZCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIHByb2ZpbGVTYXZlQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcblxuICBjb25zdCB1cGRhdGVkVXNlckluZm8gPSB7XG4gICAgbmFtZTogaW5wdXRWYWx1ZXMubmFtZSxcbiAgICBhYm91dDogaW5wdXRWYWx1ZXMuYWJvdXQsXG4gIH07XG5cbiAgYXBpXG4gICAgLnVwZGF0ZVVzZXJJbmZvKHVwZGF0ZWRVc2VySW5mbylcbiAgICAudGhlbigodXBkYXRlZERhdGEpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVwZGF0ZWREYXRhKTtcbiAgICAgIHByb2ZpbGVNb2RhbC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGRhdGluZyB1c2VyIGluZm9ybWF0aW9uOlwiLCBlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgcHJvZmlsZVNhdmVCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChpbnB1dFZhbHVlcykge1xuICBhZGRDYXJkU2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gIGNvbnN0IG5hbWUgPSBpbnB1dFZhbHVlcy50aXRsZTtcbiAgY29uc3QgbGluayA9IGlucHV0VmFsdWVzLmltYWdlO1xuICBjb25zdCBkYXRhID0geyBuYW1lLCBsaW5rLCBsaWtlczogW10gfTtcblxuICBhcGlcbiAgICAuY3JlYXRlQ2FyZChkYXRhKVxuICAgIC50aGVuKChuZXdDYXJkKSA9PiB7XG4gICAgICBjYXJkc1NlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKG5ld0NhcmQpKTtcbiAgICAgIGNhcmRNb2RhbC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBjcmVhdGluZyBjYXJkOlwiLCBlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYWRkQ2FyZFNhdmVCdXR0b24udGV4dENvbnRlbnQgPSBcIkNyZWF0ZVwiO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRJZCkge1xuICBhcGlcbiAgICAuZGVsZXRlQ2FyZChjYXJkSWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1pZD0nJHtjYXJkSWR9J11gKTtcbiAgICAgIGlmIChjYXJkRWxlbWVudCkge1xuICAgICAgICBjYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICAgIH1cbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZGVsZXRpbmcgY2FyZDpcIiwgZXJyKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFySW1hZ2VTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgaWYgKGF2YXRhclNhdmVCdXR0b24pIHtcbiAgICBhdmF0YXJTYXZlQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgfVxuXG4gIGNvbnN0IGF2YXRhclVybCA9IGlucHV0VmFsdWVzLmF2YXRhcjtcbiAgaWYgKGF2YXRhclVybCkge1xuICAgIGFwaVxuICAgICAgLnVwZGF0ZVVzZXJBdmF0YXIoYXZhdGFyVXJsKVxuICAgICAgLnRoZW4oKHVwZGF0ZWREYXRhKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiVXNlciBhdmF0YXIgdXBkYXRlZCBzdWNjZXNzZnVsbHk6XCIsIHVwZGF0ZWREYXRhKTtcbiAgICAgICAgdXBkYXRlQXZhdGFyVUkodXBkYXRlZERhdGEuYXZhdGFyKTtcbiAgICAgICAgYXZhdGFyRWRpdE1vZGFsLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIHVzZXIgYXZhdGFyOlwiLCBlcnIpO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgaWYgKGF2YXRhclVwZGF0ZUJ1dHRvbikge1xuICAgICAgICAgIGF2YXRhclNhdmVCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgY29uc29sZS5lcnJvcihcIkF2YXRhciBVUkwgaXMgcmVxdWlyZWQuXCIpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUF2YXRhclVJKGF2YXRhclVybCkge1xuICBhdmF0YXJJbWFnZS5zcmMgPSBhdmF0YXJVcmw7XG5cbiAgY29uc3QgYXZhdGFyVXBkYXRlRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoXCJhdmF0YXJVcGRhdGVcIiwge1xuICAgIGRldGFpbDogYXZhdGFyVXJsLFxuICB9KTtcbiAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChhdmF0YXJVcGRhdGVFdmVudCk7XG59XG5cbi8vIFZBTElEQVRJT05cblxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoZm9ybUxpc3QpID0+IHtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybSkgPT4ge1xuICAgIGNvbnN0IGZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgZm9ybSk7XG4gICAgZm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybS5nZXRBdHRyaWJ1dGUoXCJpZFwiKV0gPSBmb3JtVmFsaWRhdG9yO1xuICAgIHJldHVybiBmb3JtVmFsaWRhdG9ycztcbiAgfSk7XG59O1xuXG5lbmFibGVWYWxpZGF0aW9uKGZvcm1MaXN0KTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XG4gIH1cblxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgZ2V0VXNlckluZm9BbmRDYXJkcygpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckluZm8oKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGNhcmREYXRhKSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgbGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHVubGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHVwZGF0ZVVzZXJJbmZvKHVzZXJJbmZvKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodXNlckluZm8pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICB1cGRhdGVVc2VyQXZhdGFyKGF2YXRhclVybCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhcjogYXZhdGFyVXJsIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX3JlbmRlckl0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgaXRlbXMucmV2ZXJzZSgpLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShpdGVtKSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbSk7XG4gIH1cblxuICBnZXRJdGVtKGl0ZW1JZCkge1xuICAgIHJldHVybiB0aGlzLl9yZW5kZXJJdGVtcy5maW5kKChpdGVtKSA9PiBpdGVtLmlkID09PSBpdGVtSWQpO1xuICB9XG59XG4iLCJpbXBvcnQgTW9kYWwgZnJvbSBcIi4vTW9kYWwuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxXaXRoSW1hZ2UgZXh0ZW5kcyBNb2RhbCB7XG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IpIHtcbiAgICBzdXBlcih7IG1vZGFsU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fbW9kYWxJbWFnZSA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbiAgICB0aGlzLl9tb2RhbEltYWdlQ2FwdGlvbiA9XG4gICAgICB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcbiAgfVxuXG4gIG9wZW4oZGF0YSkge1xuICAgIHRoaXMuX21vZGFsSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX21vZGFsSW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX21vZGFsSW1hZ2VDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX21vZGFsSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgTW9kYWwgZnJvbSBcIi4vTW9kYWwuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxFZGl0QXZhdGFyIGV4dGVuZHMgTW9kYWwge1xuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yLCBoYW5kbGVBdmF0YXJJbWFnZVN1Ym1pdCkge1xuICAgIHN1cGVyKHsgbW9kYWxTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9tb2RhbEZvcm0gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnQgPSB0aGlzLl9tb2RhbEZvcm0ucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItaW1hZ2UtaW5wdXRcIik7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50ID0gdGhpcy5fbW9kYWxGb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIiNhdmF0YXItaW1hZ2UtaW5wdXQtZXJyb3JcIlxuICAgICk7XG4gICAgdGhpcy5faGFuZGxlQXZhdGFySW1hZ2VTdWJtaXQgPSBoYW5kbGVBdmF0YXJJbWFnZVN1Ym1pdDtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIGNvbnN0IGF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ1dHRvblwiKTtcbiAgICBhdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwiQXZhdGFyIGJ1dHRvbiBjbGlja2VkXCIpO1xuICAgICAgdGhpcy5vcGVuKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9tb2RhbEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCBhdmF0YXJVcmwgPSB0aGlzLl9pbnB1dEVsZW1lbnQudmFsdWUudHJpbSgpO1xuICAgICAgaWYgKGF2YXRhclVybCkge1xuICAgICAgICB0aGlzLl9oYW5kbGVBdmF0YXJJbWFnZVN1Ym1pdCh7IGF2YXRhcjogYXZhdGFyVXJsIH0pO1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiQXZhdGFyIFVSTCBpcyByZXF1aXJlZC5cIik7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbERlbGV0ZUNhcmQgZXh0ZW5kcyBNb2RhbCB7XG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IsIGhhbmRsZURlbGV0ZUNhcmRTdWJtaXQpIHtcbiAgICBzdXBlcih7IG1vZGFsU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZFN1Ym1pdCA9IGhhbmRsZURlbGV0ZUNhcmRTdWJtaXQ7XG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbiA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9jb25maXJtQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBjb25zdCBjYXJkSWQgPSB0aGlzLl9tb2RhbEVsZW1lbnQuZGF0YXNldC5jYXJkSWQ7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkU3VibWl0KGNhcmRJZCk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cblxuICBvcGVuKGNhcmRJZFRvRGVsZXRlKSB7XG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmRhdGFzZXQuY2FyZElkID0gY2FyZElkVG9EZWxldGU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHtcbiAgICBuYW1lRWxlbWVudFNlbGVjdG9yLFxuICAgIGFib3V0RWxlbWVudFNlbGVjdG9yLFxuICAgIGF2YXRhckltYWdlU2VsZWN0b3IsXG4gIH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZUVsZW1lbnRTZWxlY3Rvcik7XG4gICAgdGhpcy5fYWJvdXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhYm91dEVsZW1lbnRTZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFySW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhckltYWdlU2VsZWN0b3IpO1xuXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImF2YXRhclVwZGF0ZVwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IGF2YXRhclVybCA9IGV2ZW50LmRldGFpbDtcbiAgICAgIHRoaXMuX2F2YXRhckltYWdlLnNyYyA9IGF2YXRhclVybDtcbiAgICB9KTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHRoaXMuX3VzZXJJbmZvID0ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICBhYm91dDogdGhpcy5fYWJvdXRFbGVtZW50LnRleHRDb250ZW50LFxuICAgIH07XG5cbiAgICByZXR1cm4gdGhpcy5fdXNlckluZm87XG4gIH1cblxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fYWJvdXRFbGVtZW50LnRleHRDb250ZW50ID0gYWJvdXQ7XG4gIH1cbiAgZ2V0VXNlcklkKCkge1xuICAgIHJldHVybiB0aGlzLl91c2VySWQ7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9mb3JtIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Vycm9yTGlzdCIsImVycm9yTGlzdCIsIl9pbnB1dEVsZW1lbnRzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJxdWVyeVNlbGVjdG9yIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiX2Vycm9yTWVzc2FnZUVsZW1lbnQiLCJpZCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJzb21lIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZGlzYWJsZWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJyZXNldCIsIkNhcmQiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZUxpa2VDYXJkIiwiaGFuZGxlVW5saWtlQ2FyZCIsImhhbmRsZURlbGV0ZUJ1dHRvbkNsaWNrIiwiY3VycmVudFVzZXJJZCIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9pZCIsIl9pc0xpa2VkIiwiaXNBcnJheSIsImxpa2VzIiwibGlrZSIsIl9jYXJkU2VsZWN0b3IiLCJfZGF0YSIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUJ1dHRvbkNsaWNrIiwiX2hhbmRsZUxpa2VDYXJkIiwiX2hhbmRsZVVubGlrZUNhcmQiLCJfY3VycmVudFVzZXJJZCIsIl9jYXJkRWxlbWVudCIsIl9nZXRUZW1wbGF0ZSIsInRlbXBsYXRlIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2xpa2VCdXR0b24iLCJfZGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZUVsIiwiX2hhbmRsZUxpa2VCdXR0b24iLCJ0aGVuIiwiX3VwZGF0ZUxpa2VTdGF0dXMiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImdldFZpZXciLCJfZWxlbWVudCIsInNldEF0dHJpYnV0ZSIsInNyYyIsImFsdCIsInVwZGF0ZUxpa2VTdGF0dXMiLCJpc0xpa2VkIiwiTW9kYWwiLCJfcmVmIiwibW9kYWxTZWxlY3RvciIsIl9tb2RhbEVsZW1lbnQiLCJfY2xvc2VCdXR0b24iLCJfaGFuZGxlRXNjYXBlS2V5IiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJ0YXJnZXQiLCJjb250YWlucyIsIk1vZGFsV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfbW9kYWxGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJzZXRFdmVudExpc3RlbmVycyIsImZvcm1MaXN0IiwicHJvZmlsZUVkaXRCdXR0b24iLCJhZGRjcmVhdGVDYXJkQnV0dG9uIiwiZm9ybXMiLCJmb3JtU2VsZWN0b3IiLCJuYW1lSW5wdXQiLCJhYm91dElucHV0IiwiYXZhdGFySW1hZ2UiLCJhdmF0YXJTYXZlQnV0dG9uIiwicHJvZmlsZVNhdmVCdXR0b24iLCJhZGRDYXJkU2F2ZUJ1dHRvbiIsImFwaSIsIm9wdGlvbnMiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRVc2VySW5mb0FuZENhcmRzIiwiYWxsIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsImNyZWF0ZUNhcmQiLCJjYXJkRGF0YSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImxpa2VDYXJkIiwidW5saWtlQ2FyZCIsInVwZGF0ZVVzZXJJbmZvIiwidXNlckluZm8iLCJ1cGRhdGVVc2VyQXZhdGFyIiwiYXZhdGFyVXJsIiwiYXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsImNhcmRzU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9yZW5kZXJJdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsInJldmVyc2UiLCJpdGVtIiwiYWRkSXRlbSIsInByZXBlbmQiLCJnZXRJdGVtIiwiaXRlbUlkIiwiZmluZCIsImNhcmRFbGVtZW50IiwicHJvZmlsZU1vZGFsIiwidXBkYXRlZFVzZXJJbmZvIiwiYWJvdXQiLCJ1cGRhdGVkRGF0YSIsInNldFVzZXJJbmZvIiwiZmluYWxseSIsImNhcmRNb2RhbCIsInRpdGxlIiwiaW1hZ2UiLCJuZXdDYXJkIiwicHJldmlld0ltYWdlTW9kYWwiLCJfbW9kYWxJbWFnZSIsIl9tb2RhbEltYWdlQ2FwdGlvbiIsImF2YXRhckVkaXRNb2RhbCIsImhhbmRsZUF2YXRhckltYWdlU3VibWl0IiwiX2lucHV0RWxlbWVudCIsIl9lcnJvckVsZW1lbnQiLCJfaGFuZGxlQXZhdGFySW1hZ2VTdWJtaXQiLCJsb2ciLCJldmVudCIsInRyaW0iLCJhdmF0YXJVcGRhdGVFdmVudCIsIkN1c3RvbUV2ZW50IiwiZGV0YWlsIiwiZGlzcGF0Y2hFdmVudCIsInVwZGF0ZUF2YXRhclVJIiwiYXZhdGFyVXBkYXRlQnV0dG9uIiwiZGVsZXRlQ2FyZE1vZGFsIiwiaGFuZGxlRGVsZXRlQ2FyZFN1Ym1pdCIsIl9oYW5kbGVEZWxldGVDYXJkU3VibWl0IiwiX2NvbmZpcm1CdXR0b24iLCJkYXRhc2V0IiwiY2FyZElkVG9EZWxldGUiLCJuYW1lRWxlbWVudFNlbGVjdG9yIiwiYWJvdXRFbGVtZW50U2VsZWN0b3IiLCJhdmF0YXJJbWFnZVNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2Fib3V0RWxlbWVudCIsIl9hdmF0YXJJbWFnZSIsIl91c2VySW5mbyIsIl9yZWYyIiwiZ2V0VXNlcklkIiwiX3VzZXJJZCIsImNhcmQiLCJ1c2VyRGF0YSIsImluaXRpYWxDYXJkcyIsIm1hcCIsImN1cnJlbnRVc2VyIiwiZm9ybVZhbGlkYXRvcnMiLCJmb3JtIiwiZm9ybVZhbGlkYXRvciIsImdldEF0dHJpYnV0ZSJdLCJzb3VyY2VSb290IjoiIn0=