!function(){"use strict";class e{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._errorList=e.errorList,this._inputElements=Array.from(this._form.querySelectorAll(this._inputSelector)),this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageElement.textContent=e.validationMessage,this._errorMessageElement.classList.add(this._errorClass)}_hideInputError(e){this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageElement.textContent="",this._errorMessageElement.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return Array.from(this._inputElements).some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._form.reset(),this._toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}}class t{constructor(e,t,s,r){this._name=e.name,this._link=e.link,this._id=e._id,this._cardSelector=t,this._data=e,this._handleImageClick=s,this._handleDeleteClick=r,this._cardElement=this._getTemplate()}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._likeButton.addEventListener("click",(()=>{this._handleLikeButton()})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteButton()})),this._cardImageEl.addEventListener("click",(()=>{this._handleImageClick(this._data)}))}_handleLikeButton(){this._likeButton.classList.toggle("card__like-button-active")}_handleDeleteButton(){this._handleDeleteClick(this._id)}getView(){return this._element=this._cardElement,this._cardImageEl=this._element.querySelector(".card__image"),this._element.setAttribute("data-id",this._id),this._element.querySelector(".card__title").textContent=this._name,this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._setEventListeners(),this._element}}class s{constructor(e){let{modalSelector:t}=e;this._modalElement=document.querySelector(t),this._closeButton=this._modalElement.querySelector(".modal__close"),this._handleEscapeKey=this._handleEscapeKey.bind(this)}open(){this._modalElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscapeKey)}close(){this._modalElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscapeKey)}_handleEscapeKey(e){"Escape"===e.key&&this.close()}_setEventListeners(){this._modalElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()})),this._closeButton.addEventListener("click",(()=>{this.close()}))}}class r extends s{constructor(e,t){super({modalSelector:e}),this._modalForm=this._modalElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputElements=this._modalForm.querySelectorAll(".modal__input")}_getInputValues(){const e={};return this._inputElements.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super._setEventListeners(),this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}}class n{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInfoAndCards(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}createCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}updateUserInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((e=>e.ok?e.json():Promise.reject(`Error updating user info: ${e.status}`)))}}new n({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a44aa497-1b5c-4737-a030-aa953cdc7c47","Content-Type":"application/json"}}).getInitialCards().then((e=>{console.log(e)})).catch((e=>{console.log(e)}));const o=document.querySelectorAll(".modal__form"),i=document.querySelector("#profile__edit-button-js"),a=(document.forms["profile-edit-form"],document.querySelector("#profile__add-button-js")),l={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible",errorList:"modal__error"},c=document.querySelector("[name='name']"),d=document.querySelector("[name='about']"),h=new n({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a44aa497-1b5c-4737-a030-aa953cdc7c47","Content-Type":"application/json"}}),_=new class{constructor(e,t){let{items:s,renderer:r}=e;this._renderItems=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(e){e.reverse().forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[],renderer:function(e){const t=f(e);_.addItem(t)}},".cards__list"),m=new r("#profile-edit-modal",(function(e){const t={name:e.name,about:e.about};h.updateUserInfo(t).then((e=>{p.setUserInfo(e),m.close()})).catch((e=>{console.error("Error updating user information:",e)}))}));m.setEventListeners();const u=new r("#add-button-modal",(function(e){const t={name:e.title,link:e.image};h.createCard(t).then((e=>{_.addItem(f(e)),u.close()})).catch((e=>{console.error("Error creating card:",e)}))}));u.setEventListeners();const E=new class extends s{constructor(e){super({modalSelector:e}),this._modalImage=this._modalElement.querySelector(".modal__image"),this._modalImageCaption=this._modalElement.querySelector(".modal__caption")}open(e){this._modalImage.src=e.link,this._modalImage.alt=e.name,this._modalImageCaption.textContent=e.name,super.open()}setEventListeners(){super._setEventListeners(),this._modalImage.addEventListener("submit",(e=>{e.preventDefault()}))}}("#preview-image-modal");E.setEventListeners();const p=new class{constructor(e){let{nameElementSelector:t,aboutElementSelector:s}=e;this._nameElement=document.querySelector(t),this._aboutElement=document.querySelector(s)}getUserInfo(){return this._userInfo={name:this._nameElement.textContent,about:this._aboutElement.textContent},this._userInfo}setUserInfo(e){let{name:t,about:s}=e;this._nameElement.textContent=t,this._aboutElement.textContent=s}}({nameElementSelector:".profile__title",aboutElementSelector:".profile__description"});function f(e){return new t(e,"#card-template",(()=>{E.open(e)}),v).getView()}function v(e){h.deleteCard(e).then((()=>{const t=document.querySelector(`[data-id='${e}']`);t&&t.remove()})).catch((e=>{console.error("Error deleting card:",e)}))}document.addEventListener("DOMContentLoaded",(()=>{h.getUserInfoAndCards().then((e=>{let[t,s]=e;c.value=t.name||"",d.value=t.about||"",p.setUserInfo(t),_.renderItems(s)})).catch((e=>{console.error("Error fetching user info and cards:",e)}))})),i.addEventListener("click",(()=>{const e=p.getUserInfo();c.value=e.name.trim(),d.value=e.about.trim(),m.open()})),a.addEventListener("click",(()=>{u.open(),b["add-button-form"].resetValidation()}));const b={};(t=>{t.forEach((t=>{const s=new e(l,t);return s.enableValidation(),b[t.getAttribute("id")]=s,b}))})(o)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFheEUsTUFBTSxJQUdyQnFELEVBQW9CaEcsaUJBQWlCLFNBQVMsS0FDNUN5SCxFQUFVOUUsT0FDVmdHLEVBQWUsbUJBQW1CdkksaUJBQWlCLElBc0RyRCxNQUFNdUksRUFBaUIsQ0FBQyxFQUNFN0MsS0FDeEJBLEVBQVMvRixTQUFTNkksSUFDaEIsTUFBTUMsRUFBZ0IsSUFBSXhMLEVBQWNFLEVBQVVxTCxHQUdsRCxPQUZBQyxFQUFjM0ksbUJBQ2R5SSxFQUFlQyxFQUFLRSxhQUFhLE9BQVNELEVBQ25DRixDQUFjLEdBQ3JCLEVBR0p6SSxDQUFpQjRGLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvTW9kYWwuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL01vZGFsV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Nb2RhbFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckxpc3QgPSBzZXR0aW5ncy5lcnJvckxpc3Q7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcbiAgICApO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLl9pbnB1dEVsZW1lbnRzKS5zb21lKFxuICAgICAgKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxuICAgICk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUltYWdlQ2xpY2ssIGhhbmRsZURlbGV0ZUNsaWNrKSB7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIHJldHVybiBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5jYXJkX19kZWxldGUtYnV0dG9uXCJcbiAgICApO1xuXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbigpO1xuICAgIH0pO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uKCk7XG4gICAgfSk7XG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fZGF0YSk7XG4gICAgfSk7XG4gIH1cblxuICBfaGFuZGxlTGlrZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbi1hY3RpdmVcIik7XG4gIH1cblxuICBfaGFuZGxlRGVsZXRlQnV0dG9uKCkge1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMuX2lkKTtcbiAgfVxuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50O1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2VsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCB0aGlzLl9pZCk7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWwge1xuICBjb25zdHJ1Y3Rvcih7IG1vZGFsU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX21vZGFsRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobW9kYWxTZWxlY3Rvcik7XG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG4gICAgdGhpcy5faGFuZGxlRXNjYXBlS2V5ID0gdGhpcy5faGFuZGxlRXNjYXBlS2V5LmJpbmQodGhpcyk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY2FwZUtleSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NhcGVLZXkpO1xuICB9XG5cbiAgX2hhbmRsZUVzY2FwZUtleShlKSB7XG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX21vZGFsRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhGb3JtIGV4dGVuZHMgTW9kYWwge1xuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIoeyBtb2RhbFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX21vZGFsRm9ybSA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSB0aGlzLl9tb2RhbEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fbW9kYWxGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XG4gIH1cblxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgZ2V0VXNlckluZm9BbmRDYXJkcygpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckluZm8oKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGNhcmREYXRhKSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgdXBkYXRlVXNlckluZm8odXNlckluZm8pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh1c2VySW5mbyksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvciB1cGRhdGluZyB1c2VyIGluZm86ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxufVxuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJhNDRhYTQ5Ny0xYjVjLTQ3MzctYTAzMC1hYTk1M2NkYzdjNDdcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5hcGlcbiAgLmdldEluaXRpYWxDYXJkcygpXG4gIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycik7XG4gIH0pO1xuIiwiZXhwb3J0IGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGVfX2VkaXQtYnV0dG9uLWpzXCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWVkaXQtZm9ybVwiXTtcblxuZXhwb3J0IGNvbnN0IGFkZGNyZWF0ZUNhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlX19hZGQtYnV0dG9uLWpzXCJcbik7XG5cbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG4gIGVycm9yTGlzdDogXCJtb2RhbF9fZXJyb3JcIixcbn07XG5cbmV4cG9ydCBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiW25hbWU9J25hbWUnXVwiKTtcbmV4cG9ydCBjb25zdCBhYm91dElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIltuYW1lPSdhYm91dCddXCIpO1xuIiwiLy8gSU1QT1JUU1xuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBNb2RhbFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Nb2RhbFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IE1vZGFsV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvTW9kYWxXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IHtcbiAgZm9ybUxpc3QsXG4gIHNldHRpbmdzLFxuICBwcm9maWxlRWRpdEJ1dHRvbixcbiAgYWRkY3JlYXRlQ2FyZEJ1dHRvbixcbiAgbmFtZUlucHV0LFxuICBhYm91dElucHV0LFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbi8vIEFQSVxuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJhNDRhYTQ5Ny0xYjVjLTQ3MzctYTAzMC1hYTk1M2NkYzdjNDdcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vLyBTRUNUSU9OIENMQVNTXG5cbmNvbnN0IGNhcmRzU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgaXRlbXM6IFtdLFxuICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkLFxuICB9LFxuICBcIi5jYXJkc19fbGlzdFwiXG4pO1xuXG4vLyBNT0RBTFNcblxuY29uc3QgcHJvZmlsZU1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oXG4gIFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxuICBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdFxuKTtcbnByb2ZpbGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBjYXJkTW9kYWwgPSBuZXcgTW9kYWxXaXRoRm9ybShcIiNhZGQtYnV0dG9uLW1vZGFsXCIsIGhhbmRsZUFkZENhcmRTdWJtaXQpO1xuY2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gbmV3IE1vZGFsV2l0aEltYWdlKFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIik7XG5wcmV2aWV3SW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBVU0VSIElORk9cblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lRWxlbWVudFNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICBhYm91dEVsZW1lbnRTZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbn0pO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XG4gIGFwaVxuICAgIC5nZXRVc2VySW5mb0FuZENhcmRzKClcbiAgICAudGhlbigoW3VzZXJEYXRhLCBpbml0aWFsQ2FyZHNdKSA9PiB7XG4gICAgICBuYW1lSW5wdXQudmFsdWUgPSB1c2VyRGF0YS5uYW1lIHx8IFwiXCI7XG4gICAgICBhYm91dElucHV0LnZhbHVlID0gdXNlckRhdGEuYWJvdXQgfHwgXCJcIjtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcbiAgICAgIGNhcmRzU2VjdGlvbi5yZW5kZXJJdGVtcyhpbml0aWFsQ2FyZHMpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyB1c2VyIGluZm8gYW5kIGNhcmRzOlwiLCBlcnIpO1xuICAgIH0pO1xufSk7XG5cbi8vIEZVTkNUSU9OU1xuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGRhdGEpIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZChcbiAgICBkYXRhLFxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICAoKSA9PiB7XG4gICAgICBwcmV2aWV3SW1hZ2VNb2RhbC5vcGVuKGRhdGEpO1xuICAgIH0sXG4gICAgaGFuZGxlRGVsZXRlQ2FyZFxuICApO1xuICByZXR1cm4gY2FyZEVsZW1lbnQuZ2V0VmlldygpO1xufVxuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XG4gIGNhcmRzU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbn1cblxuLy8gRVZFTlQgTElTVEVORVJTXG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IGN1cnJlbnRVc2VyID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgbmFtZUlucHV0LnZhbHVlID0gY3VycmVudFVzZXIubmFtZS50cmltKCk7XG4gIGFib3V0SW5wdXQudmFsdWUgPSBjdXJyZW50VXNlci5hYm91dC50cmltKCk7XG5cbiAgcHJvZmlsZU1vZGFsLm9wZW4oKTtcbn0pO1xuXG5hZGRjcmVhdGVDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNhcmRNb2RhbC5vcGVuKCk7XG4gIGZvcm1WYWxpZGF0b3JzW1wiYWRkLWJ1dHRvbi1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG5cbi8vIEVWRU5UIEhBTkRMRVJTXG5cbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIGNvbnN0IHVwZGF0ZWRVc2VySW5mbyA9IHtcbiAgICBuYW1lOiBpbnB1dFZhbHVlcy5uYW1lLFxuICAgIGFib3V0OiBpbnB1dFZhbHVlcy5hYm91dCxcbiAgfTtcblxuICBhcGlcbiAgICAudXBkYXRlVXNlckluZm8odXBkYXRlZFVzZXJJbmZvKVxuICAgIC50aGVuKCh1cGRhdGVkRGF0YSkgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8odXBkYXRlZERhdGEpO1xuICAgICAgcHJvZmlsZU1vZGFsLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIHVzZXIgaW5mb3JtYXRpb246XCIsIGVycik7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgY29uc3QgbmFtZSA9IGlucHV0VmFsdWVzLnRpdGxlO1xuICBjb25zdCBsaW5rID0gaW5wdXRWYWx1ZXMuaW1hZ2U7XG4gIGNvbnN0IGRhdGEgPSB7IG5hbWUsIGxpbmsgfTtcblxuICBhcGlcbiAgICAuY3JlYXRlQ2FyZChkYXRhKVxuICAgIC50aGVuKChuZXdDYXJkKSA9PiB7XG4gICAgICBjYXJkc1NlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKG5ld0NhcmQpKTtcbiAgICAgIGNhcmRNb2RhbC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBjcmVhdGluZyBjYXJkOlwiLCBlcnIpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRJZCkge1xuICBhcGlcbiAgICAuZGVsZXRlQ2FyZChjYXJkSWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1pZD0nJHtjYXJkSWR9J11gKTtcbiAgICAgIGlmIChjYXJkRWxlbWVudCkge1xuICAgICAgICBjYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICAgIH1cbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZGVsZXRpbmcgY2FyZDpcIiwgZXJyKTtcbiAgICB9KTtcbn1cblxuLy8gVkFMSURBVElPTlxuXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChmb3JtTGlzdCkgPT4ge1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtKSA9PiB7XG4gICAgY29uc3QgZm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBmb3JtKTtcbiAgICBmb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtLmdldEF0dHJpYnV0ZShcImlkXCIpXSA9IGZvcm1WYWxpZGF0b3I7XG4gICAgcmV0dXJuIGZvcm1WYWxpZGF0b3JzO1xuICB9KTtcbn07XG5cbmVuYWJsZVZhbGlkYXRpb24oZm9ybUxpc3QpO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcmVuZGVySXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcbiAgICBpdGVtcy5yZXZlcnNlKCkuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGl0ZW0pIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcbiAgfVxufVxuIiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsV2l0aEltYWdlIGV4dGVuZHMgTW9kYWwge1xuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBtb2RhbFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX21vZGFsSW1hZ2UgPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG4gICAgdGhpcy5fbW9kYWxJbWFnZUNhcHRpb24gPVxuICAgICAgdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XG4gIH1cblxuICBvcGVuKGRhdGEpIHtcbiAgICB0aGlzLl9tb2RhbEltYWdlLnNyYyA9IGRhdGEubGluaztcbiAgICB0aGlzLl9tb2RhbEltYWdlLmFsdCA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9tb2RhbEltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9tb2RhbEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIC8vIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lRWxlbWVudFNlbGVjdG9yLCBhYm91dEVsZW1lbnRTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVFbGVtZW50U2VsZWN0b3IpO1xuICAgIHRoaXMuX2Fib3V0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWJvdXRFbGVtZW50U2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgdGhpcy5fdXNlckluZm8gPSB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGFib3V0OiB0aGlzLl9hYm91dEVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgfTtcblxuICAgIHJldHVybiB0aGlzLl91c2VySW5mbztcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9hYm91dEVsZW1lbnQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2Zvcm0iLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZXJyb3JMaXN0IiwiZXJyb3JMaXN0IiwiX2lucHV0RWxlbWVudHMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsInF1ZXJ5U2VsZWN0b3IiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJfZXJyb3JNZXNzYWdlRWxlbWVudCIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsInJlbW92ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsInNvbWUiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJkaXNhYmxlZCIsIl9zZXRFdmVudExpc3RlbmVycyIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsInJlc2V0IiwiQ2FyZCIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfY2FyZFNlbGVjdG9yIiwiX2RhdGEiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9jYXJkRWxlbWVudCIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsIl9saWtlQnV0dG9uIiwiX2RlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiX2hhbmRsZURlbGV0ZUJ1dHRvbiIsIl9jYXJkSW1hZ2VFbCIsInRvZ2dsZSIsImdldFZpZXciLCJfZWxlbWVudCIsInNldEF0dHJpYnV0ZSIsInNyYyIsImFsdCIsIk1vZGFsIiwiX3JlZiIsIm1vZGFsU2VsZWN0b3IiLCJfbW9kYWxFbGVtZW50IiwiX2Nsb3NlQnV0dG9uIiwiX2hhbmRsZUVzY2FwZUtleSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5IiwidGFyZ2V0IiwiY29udGFpbnMiLCJNb2RhbFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX21vZGFsRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJBcGkiLCJvcHRpb25zIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm9BbmRDYXJkcyIsImFsbCIsImdldFVzZXJJbmZvIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwiY3JlYXRlQ2FyZCIsImNhcmREYXRhIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwidXBkYXRlVXNlckluZm8iLCJ1c2VySW5mbyIsImF1dGhvcml6YXRpb24iLCJyZXN1bHQiLCJjb25zb2xlIiwibG9nIiwiY2F0Y2giLCJlcnIiLCJmb3JtTGlzdCIsInByb2ZpbGVFZGl0QnV0dG9uIiwiYWRkY3JlYXRlQ2FyZEJ1dHRvbiIsImZvcm1zIiwiZm9ybVNlbGVjdG9yIiwibmFtZUlucHV0IiwiYWJvdXRJbnB1dCIsImFwaSIsImNhcmRzU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9yZW5kZXJJdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsInJldmVyc2UiLCJpdGVtIiwiYWRkSXRlbSIsInByZXBlbmQiLCJjYXJkRWxlbWVudCIsInByb2ZpbGVNb2RhbCIsInVwZGF0ZWRVc2VySW5mbyIsImFib3V0IiwidXBkYXRlZERhdGEiLCJzZXRVc2VySW5mbyIsImVycm9yIiwiY2FyZE1vZGFsIiwidGl0bGUiLCJpbWFnZSIsIm5ld0NhcmQiLCJwcmV2aWV3SW1hZ2VNb2RhbCIsIl9tb2RhbEltYWdlIiwiX21vZGFsSW1hZ2VDYXB0aW9uIiwibmFtZUVsZW1lbnRTZWxlY3RvciIsImFib3V0RWxlbWVudFNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2Fib3V0RWxlbWVudCIsIl91c2VySW5mbyIsIl9yZWYyIiwiaGFuZGxlRGVsZXRlQ2FyZCIsInVzZXJEYXRhIiwiaW5pdGlhbENhcmRzIiwiY3VycmVudFVzZXIiLCJ0cmltIiwiZm9ybVZhbGlkYXRvcnMiLCJmb3JtIiwiZm9ybVZhbGlkYXRvciIsImdldEF0dHJpYnV0ZSJdLCJzb3VyY2VSb290IjoiIn0=